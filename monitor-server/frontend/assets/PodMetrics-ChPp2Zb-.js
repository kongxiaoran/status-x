import{_ as R,r as m,c as S,o as T,a as H,b as x,d as r,g as e,h as t,k as a,l as h,u as f,A as w,B as j,v as _,F as q,i as G,e as J,t as b,m as K,x as O}from"./index-gPU_9OLY.js";import{a as Q}from"./index-gBsGVmo7.js";const W={class:"pod-metrics"},X={class:"control-panel"},Y={class:"card-header"},Z={class:"pod-name"},ee={class:"pod-info"},oe={class:"metrics"},te={class:"metric-item"},le={class:"metric-label"},ae={class:"metric-item"},se={class:"metric-label"},ne={__name:"PodMetrics",setup(re){const I=O(),y=m([]),v=m("name"),d=m(""),u=m(""),U=S(()=>{let s=y.value;return d.value&&(s=s.filter(o=>o.node_ip.includes(d.value))),u.value&&(s=s.filter(o=>{var n;return(n=o.namespace)==null?void 0:n.includes(u.value)})),[...s].sort((o,n)=>{switch(v.value){case"cpu":return n.cpu_usage-o.cpu_usage;case"memory":return n.memory_usage-o.memory_usage;default:const P=o.node_ip||"zzzzzzzzzzzzz",c=n.node_ip||"zzzzzzzzzzzzz",i=P.localeCompare(c);return i!==0?i:o.ip.localeCompare(n.ip)}})});function k(s){I.push(`/pod-details/${s}`)}async function z(){try{const s=new URLSearchParams({host_ip:d.value,namespace:u.value}),o=await Q.getPodDashboard(`${s}`);y.value=o}catch(s){console.error("加载Pod数据失败:",s),ElMessage.error("加载Pod数据时出现错误")}}function B(){z()}let g;return T(()=>{z(),g=setInterval(z,2e3)}),H(()=>{g&&clearInterval(g)}),(s,o)=>{const n=a("el-option"),P=a("el-select"),c=a("el-icon"),i=a("el-input"),F=a("el-button"),N=a("el-space"),M=a("el-tooltip"),C=a("el-descriptions-item"),$=a("el-descriptions"),D=a("CPU"),V=a("el-progress"),E=a("el-card"),A=a("el-col"),L=a("el-row");return h(),x("div",W,[o[6]||(o[6]=r("h2",{class:"page-title"},"Pod 资源监控",-1)),r("div",X,[e(N,{wrap:""},{default:t(()=>[e(P,{modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=l=>v.value=l),placeholder:"排序方式"},{default:t(()=>[e(n,{label:"按 Pod IP 排序",value:"name"}),e(n,{label:"按 CPU 占用排序",value:"cpu"}),e(n,{label:"按内存占用排序",value:"memory"})]),_:1},8,["modelValue"]),e(i,{modelValue:d.value,"onUpdate:modelValue":o[1]||(o[1]=l=>d.value=l),placeholder:"搜索宿主机 IP",clearable:""},{prefix:t(()=>[e(c,null,{default:t(()=>[e(f(w))]),_:1})]),_:1},8,["modelValue"]),e(i,{modelValue:u.value,"onUpdate:modelValue":o[2]||(o[2]=l=>u.value=l),placeholder:"搜索命名空间",clearable:""},{prefix:t(()=>[e(c,null,{default:t(()=>[e(f(j))]),_:1})]),_:1},8,["modelValue"]),e(F,{type:"primary",onClick:B},{default:t(()=>[e(c,null,{default:t(()=>[e(f(w))]),_:1}),o[3]||(o[3]=_(" 搜索 "))]),_:1})]),_:1})]),e(L,{gutter:20},{default:t(()=>[(h(!0),x(q,null,G(U.value,l=>(h(),J(A,{key:l.hostname,xs:24,sm:12,md:8,lg:6},{default:t(()=>[e(E,{class:"pod-card",shadow:"hover",onClick:p=>k(l.hostname)},{header:t(()=>[r("div",Y,[e(M,{content:l.hostname,placement:"top","show-after":500},{default:t(()=>[r("span",Z,b(l.hostname),1)]),_:2},1032,["content"])])]),default:t(()=>[r("div",ee,[e($,{column:1,size:"small",border:""},{default:t(()=>[e(C,{label:"Pod IP"},{default:t(()=>[_(b(l.ip),1)]),_:2},1024),e(C,{label:"节点 IP"},{default:t(()=>[_(b(l.node_ip),1)]),_:2},1024)]),_:2},1024)]),r("div",oe,[r("div",te,[r("span",le,[e(c,null,{default:t(()=>[e(D)]),_:1}),o[4]||(o[4]=_(" CPU 使用率 "))]),e(V,{percentage:Number(l.cpu_usage.toFixed(1)),format:p=>`${p}微核`,color:[{color:"#409EFF",percentage:5e3},{color:"#ed0202",percentage:1e4}]},null,8,["percentage","format"])]),r("div",ae,[r("span",se,[e(c,null,{default:t(()=>[e(f(K))]),_:1}),o[5]||(o[5]=_(" 内存使用率 "))]),e(V,{percentage:Number(l.memory_usage.toFixed(1)),format:p=>`${p}MB`,color:[{color:"#409EFF",percentage:5e3},{color:"#ed0202",percentage:1e4}]},null,8,["percentage","format"])])])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})])}}},ue=R(ne,[["__scopeId","data-v-301630e1"]]);export{ue as default};
